/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Directive, ElementRef, EventEmitter, HostListener, Input, Output, Renderer2, } from '@angular/core';
import { AngularResizeElementDirection } from './angular-resize-element.enum';
// @ts-ignore
export class AngularResizeElementDirective {
    /**
     * @param {?} elementRef
     * @param {?} renderer2
     */
    constructor(elementRef, renderer2) {
        this.elementRef = elementRef;
        this.renderer2 = renderer2;
        this.applyClass = 'resizes';
        this.resizeStart = new EventEmitter();
        this.resize = new EventEmitter();
        this.resizeEnd = new EventEmitter();
    }
    /**
     * @param {?} evt
     * @return {?}
     */
    onMouseDown(evt) {
        evt.preventDefault();
        this.setOriginalData(evt);
        this.resizeStart.emit(this.generateValuesForEvent(evt));
        this.mouseUpListener = this.renderer2.listen('document', 'mouseup', (/**
         * @param {?} event
         * @return {?}
         */
        event => this.onMouseUp(event)));
        this.mouseMoveListener = this.renderer2.listen('document', 'mousemove', (/**
         * @param {?} event
         * @return {?}
         */
        event => this.onMouseMove(event)));
        this.renderer2.addClass(this.elementRef.nativeElement, 'resizes');
    }
    /**
     * @private
     * @param {?} evt
     * @return {?}
     */
    onMouseUp(evt) {
        /** @type {?} */
        const eventValues = this.generateValuesForEvent(evt);
        this.resize.emit(eventValues);
        this.mouseMoveListener();
        this.mouseUpListener();
        this.renderer2.removeClass(this.elementRef.nativeElement, this.applyClass);
        this.resizeEnd.emit(eventValues);
    }
    /**
     * @private
     * @param {?} evt
     * @return {?}
     */
    onMouseMove(evt) {
        this.resize.emit(this.generateValuesForEvent(evt));
    }
    /**
     * @private
     * @param {?} originalEvent
     * @return {?}
     */
    setOriginalData(originalEvent) {
        this.originalEvent = originalEvent;
        if (this.targetElement) {
            /** @type {?} */
            const dataSource = this.targetElement instanceof ElementRef ? this.targetElement.nativeElement : this.targetElement;
            this.targetElementWidthValue = dataSource.offsetWidth;
            this.targetElementHeightValue = dataSource.offsetHeight;
        }
        else {
            this.targetElementWidthValue = 0;
            this.targetElementHeightValue = 0;
        }
    }
    /**
     * @private
     * @param {?} evt
     * @return {?}
     */
    generateValuesForEvent(evt) {
        /** @type {?} */
        const originalXValue = this.originalEvent.clientX;
        /** @type {?} */
        const originalYValue = this.originalEvent.clientY;
        /** @type {?} */
        let currentWidthValue = evt.clientX - originalXValue;
        /** @type {?} */
        let currentHeightValue = evt.clientY - originalYValue;
        switch (this.direction) {
            case AngularResizeElementDirection.TOP:
            case AngularResizeElementDirection.TOP_RIGHT: {
                currentHeightValue *= -1;
                break;
            }
            case AngularResizeElementDirection.BOTTOM_LEFT:
            case AngularResizeElementDirection.LEFT: {
                currentWidthValue *= -1;
                break;
            }
            case AngularResizeElementDirection.TOP_LEFT: {
                currentHeightValue *= -1;
                currentWidthValue *= -1;
                break;
            }
        }
        switch (this.direction) {
            case AngularResizeElementDirection.TOP:
            case AngularResizeElementDirection.BOTTOM: {
                currentWidthValue = 0;
                break;
            }
            case AngularResizeElementDirection.RIGHT:
            case AngularResizeElementDirection.LEFT: {
                currentHeightValue = 0;
                break;
            }
        }
        currentWidthValue += this.targetElementWidthValue;
        currentHeightValue += this.targetElementHeightValue;
        if (this.proportionalResize) {
            if (currentWidthValue > currentHeightValue) {
                currentWidthValue = currentHeightValue;
            }
            else {
                currentHeightValue = currentWidthValue;
            }
        }
        return {
            originalEvent: this.originalEvent,
            currentWidthValue: currentWidthValue,
            currentHeightValue: currentHeightValue,
            originalWidthValue: this.targetElementWidthValue,
            originalHeightValue: this.targetElementHeightValue,
            differenceWidthValue: this.targetElementWidthValue - currentWidthValue,
            differenceHeightValue: this.targetElementHeightValue - currentHeightValue,
            direction: this.direction,
        };
    }
}
AngularResizeElementDirective.decorators = [
    { type: Directive, args: [{
                selector: '[resize], [resizeStart], [resizeEnd]'
            },] }
];
/** @nocollapse */
AngularResizeElementDirective.ctorParameters = () => [
    { type: ElementRef },
    { type: Renderer2 }
];
AngularResizeElementDirective.propDecorators = {
    targetElement: [{ type: Input }],
    direction: [{ type: Input }],
    proportionalResize: [{ type: Input }],
    applyClass: [{ type: Input }],
    resizeStart: [{ type: Output }],
    resize: [{ type: Output }],
    resizeEnd: [{ type: Output }],
    onMouseDown: [{ type: HostListener, args: ['mousedown', ['$event'],] }]
};
if (false) {
    /**
     * @type {?}
     * @private
     */
    AngularResizeElementDirective.prototype.mouseUpListener;
    /**
     * @type {?}
     * @private
     */
    AngularResizeElementDirective.prototype.mouseMoveListener;
    /**
     * @type {?}
     * @private
     */
    AngularResizeElementDirective.prototype.targetElementWidthValue;
    /**
     * @type {?}
     * @private
     */
    AngularResizeElementDirective.prototype.targetElementHeightValue;
    /**
     * @type {?}
     * @private
     */
    AngularResizeElementDirective.prototype.originalEvent;
    /** @type {?} */
    AngularResizeElementDirective.prototype.targetElement;
    /** @type {?} */
    AngularResizeElementDirective.prototype.direction;
    /** @type {?} */
    AngularResizeElementDirective.prototype.proportionalResize;
    /** @type {?} */
    AngularResizeElementDirective.prototype.applyClass;
    /** @type {?} */
    AngularResizeElementDirective.prototype.resizeStart;
    /** @type {?} */
    AngularResizeElementDirective.prototype.resize;
    /** @type {?} */
    AngularResizeElementDirective.prototype.resizeEnd;
    /**
     * @type {?}
     * @private
     */
    AngularResizeElementDirective.prototype.elementRef;
    /**
     * @type {?}
     * @private
     */
    AngularResizeElementDirective.prototype.renderer2;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYW5ndWxhci1yZXNpemUtZWxlbWVudC5kaXJlY3RpdmUuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9hbmd1bGFyLXJlc2l6ZS1lbGVtZW50LyIsInNvdXJjZXMiOlsibGliL2FuZ3VsYXItcmVzaXplLWVsZW1lbnQuZGlyZWN0aXZlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQ0gsU0FBUyxFQUNULFVBQVUsRUFDVixZQUFZLEVBQ1osWUFBWSxFQUNaLEtBQUssRUFDTCxNQUFNLEVBQ04sU0FBUyxHQUNaLE1BQU0sZUFBZSxDQUFDO0FBRXZCLE9BQU8sRUFBQyw2QkFBNkIsRUFBQyxNQUFNLCtCQUErQixDQUFDOztBQU01RSxNQUFNLE9BQU8sNkJBQTZCOzs7OztJQWdDdEMsWUFBNkIsVUFBc0IsRUFDdEIsU0FBb0I7UUFEcEIsZUFBVSxHQUFWLFVBQVUsQ0FBWTtRQUN0QixjQUFTLEdBQVQsU0FBUyxDQUFXO1FBZDFDLGVBQVUsR0FBRyxTQUFTLENBQUM7UUFHdkIsZ0JBQVcsR0FBNEMsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUcxRSxXQUFNLEdBQTRDLElBQUksWUFBWSxFQUFFLENBQUM7UUFHckUsY0FBUyxHQUE0QyxJQUFJLFlBQVksRUFBRSxDQUFDO0lBTTVFLENBQUM7Ozs7O0lBS0csV0FBVyxDQUFDLEdBQWU7UUFDOUIsR0FBRyxDQUFDLGNBQWMsRUFBRSxDQUFDO1FBRXJCLElBQUksQ0FBQyxlQUFlLENBQUMsR0FBRyxDQUFDLENBQUM7UUFFMUIsSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLHNCQUFzQixDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFFeEQsSUFBSSxDQUFDLGVBQWUsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxVQUFVLEVBQUUsU0FBUzs7OztRQUFFLEtBQUssQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsRUFBQyxDQUFD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Qyx3REFBb0M7Ozs7O0lBQ3BDLDBEQUFzQzs7Ozs7SUFFdEMsZ0VBQXdDOzs7OztJQUN4QyxpRUFBeUM7Ozs7O0lBRXpDLHNEQUFrQzs7SUFFbEMsc0RBQytDOztJQUUvQyxrREFDZ0Q7O0lBRWhELDJEQUNtQzs7SUFFbkMsbURBQzhCOztJQUU5QixvREFDaUY7O0lBRWpGLCtDQUM0RTs7SUFFNUUsa0RBQytFOzs7OztJQUluRSxtREFBdUM7Ozs7O0lBQ3ZDLGtEQUFxQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XHJcbiAgICBEaXJlY3RpdmUsXHJcbiAgICBFbGVtZW50UmVmLFxyXG4gICAgRXZlbnRFbWl0dGVyLFxyXG4gICAgSG9zdExpc3RlbmVyLFxyXG4gICAgSW5wdXQsXHJcbiAgICBPdXRwdXQsXHJcbiAgICBSZW5kZXJlcjIsXHJcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7QW5ndWxhclJlc2l6ZUVsZW1lbnRFdmVudH0gZnJvbSAnLi9hbmd1bGFyLXJlc2l6ZS1lbGVtZW50LWV2ZW50LmludGVyZmFjZSc7XHJcbmltcG9ydCB7QW5ndWxhclJlc2l6ZUVsZW1lbnREaXJlY3Rpb259IGZyb20gJy4vYW5ndWxhci1yZXNpemUtZWxlbWVudC5lbnVtJztcclxuXHJcbi8vIEB0cy1pZ25vcmVcclxuQERpcmVjdGl2ZSh7XHJcbiAgICBzZWxlY3RvcjogJ1tyZXNpemVdLCBbcmVzaXplU3RhcnRdLCBbcmVzaXplRW5kXSdcclxufSlcclxuZXhwb3J0IGNsYXNzIEFuZ3VsYXJSZXNpemVFbGVtZW50RGlyZWN0aXZlIHtcclxuICAgIHByaXZhdGUgbW91c2VVcExpc3RlbmVyOiAoKSA9PiB2b2lkO1xyXG4gICAgcHJpdmF0ZSBtb3VzZU1vdmVMaXN0ZW5lcjogKCkgPT4gdm9pZDtcclxuXHJcbiAgICBwcml2YXRlIHRhcmdldEVsZW1lbnRXaWR0aFZhbHVlOiBudW1iZXI7XHJcbiAgICBwcml2YXRlIHRhcmdldEVsZW1lbnRIZWlnaHRWYWx1ZTogbnVtYmVyO1xyXG5cclxuICAgIHByaXZhdGUgb3JpZ2luYWxFdmVudDogTW91c2VFdmVudDtcclxuXHJcbiAgICBASW5wdXQoKVxyXG4gICAgcHVibGljIHRhcmdldEVsZW1lbnQ6IEhUTUxFbGVtZW50IHwgRWxlbWVudFJlZjtcclxuXHJcbiAgICBASW5wdXQoKVxyXG4gICAgcHVibGljIGRpcmVjdGlvbjogQW5ndWxhclJlc2l6ZUVsZW1lbnREaXJlY3Rpb247XHJcblxyXG4gICAgQElucHV0KClcclxuICAgIHB1YmxpYyBwcm9wb3J0aW9uYWxSZXNpemU6IGJvb2xlYW47XHJcblxyXG4gICAgQElucHV0KClcclxuICAgIHB1YmxpYyBhcHBseUNsYXNzID0gJ3Jlc2l6ZXMnO1xyXG5cclxuICAgIEBPdXRwdXQoKVxyXG4gICAgcHVibGljIHJlc2l6ZVN0YXJ0OiBFdmVudEVtaXR0ZXI8QW5ndWxhclJlc2l6ZUVsZW1lbnRFdmVudD4gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG4gICAgQE91dHB1dCgpXHJcbiAgICBwdWJsaWMgcmVzaXplOiBFdmVudEVtaXR0ZXI8QW5ndWxhclJlc2l6ZUVsZW1lbnRFdmVudD4gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG4gICAgQE91dHB1dCgpXHJcbiAgICBwdWJsaWMgcmVzaXplRW5kOiBFdmVudEVtaXR0ZXI8QW5ndWxhclJlc2l6ZUVsZW1lbnRFdmVudD4gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG5cclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIHJlYWRvbmx5IGVsZW1lbnRSZWY6IEVsZW1lbnRSZWYsXHJcbiAgICAgICAgICAgICAgICBwcml2YXRlIHJlYWRvbmx5IHJlbmRlcmVyMjogUmVuZGVyZXIyLFxyXG4gICAgKSB7fVxyXG5cclxuXHJcblxyXG4gICAgQEhvc3RMaXN0ZW5lcignbW91c2Vkb3duJywgWyckZXZlbnQnXSlcclxuICAgIHB1YmxpYyBvbk1vdXNlRG93bihldnQ6IE1vdXNlRXZlbnQpOiB2b2lkIHtcclxuICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgICAgdGhpcy5zZXRPcmlnaW5hbERhdGEoZXZ0KTtcclxuXHJcbiAgICAgICAgdGhpcy5yZXNpemVTdGFydC5lbWl0KHRoaXMuZ2VuZXJhdGVWYWx1ZXNGb3JFdmVudChldnQpKTtcclxuXHJcbiAgICAgICAgdGhpcy5tb3VzZVVwTGlzdGVuZXIgPSB0aGlzLnJlbmRlcmVyMi5saXN0ZW4oJ2RvY3VtZW50JywgJ21vdXNldXAnLCBldmVudCA9PiB0aGlzLm9uTW91c2VVcChldmVudCkpO1xyXG4gICAgICAgIHRoaXMubW91c2VNb3ZlTGlzdGVuZXIgPSB0aGlzLnJlbmRlcmVyMi5saXN0ZW4oJ2RvY3VtZW50JywgJ21vdXNlbW92ZScsIGV2ZW50ID0+IHRoaXMub25Nb3VzZU1vdmUoZXZlbnQpKTtcclxuICAgICAgICB0aGlzLnJlbmRlcmVyMi5hZGRDbGFzcyh0aGlzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudCwgJ3Jlc2l6ZXMnKTtcclxuICAgIH1cclxuXHJcblxyXG5cclxuICAgIHByaXZhdGUgb25Nb3VzZVVwKGV2dDogTW91c2VFdmVudCk6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IGV2ZW50VmFsdWVzID0gdGhpcy5nZW5lcmF0ZVZhbHVlc0ZvckV2ZW50KGV2dCk7XHJcbiAgICAgICAgdGhpcy5yZXNpemUuZW1pdChldmVudFZhbHVlcyk7XHJcbiAgICAgICAgdGhpcy5tb3VzZU1vdmVMaXN0ZW5lcigpO1xyXG4gICAgICAgIHRoaXMubW91c2VVcExpc3RlbmVyKCk7XHJcblxyXG4gICAgICAgIHRoaXMucmVuZGVyZXIyLnJlbW92ZUNsYXNzKHRoaXMuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LCB0aGlzLmFwcGx5Q2xhc3MpO1xyXG4gICAgICAgIHRoaXMucmVzaXplRW5kLmVtaXQoZXZlbnRWYWx1ZXMpO1xyXG4gICAgfVxyXG5cclxuXHJcblxyXG4gICAgcHJpdmF0ZSBvbk1vdXNlTW92ZShldnQ6IE1vdXNlRXZlbnQpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLnJlc2l6ZS5lbWl0KHRoaXMuZ2VuZXJhdGVWYWx1ZXNGb3JFdmVudChldnQpKTtcclxuICAgIH1cclxuXHJcblxyXG5cclxuICAgIHByaXZhdGUgc2V0T3JpZ2luYWxEYXRhKG9yaWdpbmFsRXZlbnQ6IE1vdXNlRXZlbnQpIHtcclxuICAgICAgICB0aGlzLm9yaWdpbmFsRXZlbnQgPSBvcmlnaW5hbEV2ZW50O1xyXG5cclxuICAgICAgICBpZiAodGhpcy50YXJnZXRFbGVtZW50KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGRhdGFTb3VyY2UgPSB0aGlzLnRhcmdldEVsZW1lbnQgaW5zdGFuY2VvZiBFbGVtZW50UmVmID8gdGhpcy50YXJnZXRFbGVtZW50Lm5hdGl2ZUVsZW1lbnQgOiB0aGlzLnRhcmdldEVsZW1lbnQ7XHJcbiAgICAgICAgICAgIHRoaXMudGFyZ2V0RWxlbWVudFdpZHRoVmFsdWUgPSBkYXRhU291cmNlLm9mZnNldFdpZHRoO1xyXG4gICAgICAgICAgICB0aGlzLnRhcmdldEVsZW1lbnRIZWlnaHRWYWx1ZSA9IGRhdGFTb3VyY2Uub2Zmc2V0SGVpZ2h0O1xyXG5cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnRhcmdldEVsZW1lbnRXaWR0aFZhbHVlID0gMDtcclxuICAgICAgICAgICAgdGhpcy50YXJnZXRFbGVtZW50SGVpZ2h0VmFsdWUgPSAwO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcblxyXG5cclxuICAgIHByaXZhdGUgZ2VuZXJhdGVWYWx1ZXNGb3JFdmVudChldnQ6IE1vdXNlRXZlbnQpOiBBbmd1bGFyUmVzaXplRWxlbWVudEV2ZW50IHtcclxuICAgICAgICBjb25zdCBvcmlnaW5hbFhWYWx1ZSA9IHRoaXMub3JpZ2luYWxFdmVudC5jbGllbnRYO1xyXG4gICAgICAgIGNvbnN0IG9yaWdpbmFsWVZhbHVlID0gdGhpcy5vcmlnaW5hbEV2ZW50LmNsaWVudFk7XHJcblxyXG4gICAgICAgIGxldCBjdXJyZW50V2lkdGhWYWx1ZSA9IGV2dC5jbGllbnRYIC0gb3JpZ2luYWxYVmFsdWU7XHJcbiAgICAgICAgbGV0IGN1cnJlbnRIZWlnaHRWYWx1ZSA9IGV2dC5jbGllbnRZIC0gb3JpZ2luYWxZVmFsdWU7XHJcblxyXG4gICAgICAgIHN3aXRjaCAodGhpcy5kaXJlY3Rpb24pIHtcclxuICAgICAgICAgICAgY2FzZSBBbmd1bGFyUmVzaXplRWxlbWVudERpcmVjdGlvbi5UT1A6XHJcbiAgICAgICAgICAgIGNhc2UgQW5ndWxhclJlc2l6ZUVsZW1lbnREaXJlY3Rpb24uVE9QX1JJR0hUOiB7XHJcbiAgICAgICAgICAgICAgICBjdXJyZW50SGVpZ2h0VmFsdWUgKj0gLTE7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXNlIEFuZ3VsYXJSZXNpemVFbGVtZW50RGlyZWN0aW9uLkJPVFRPTV9MRUZUOlxyXG4gICAgICAgICAgICBjYXNlIEFuZ3VsYXJSZXNpemVFbGVtZW50RGlyZWN0aW9uLkxFRlQ6IHtcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRXaWR0aFZhbHVlICo9IC0xO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2FzZSBBbmd1bGFyUmVzaXplRWxlbWVudERpcmVjdGlvbi5UT1BfTEVGVDoge1xyXG4gICAgICAgICAgICAgICAgY3VycmVudEhlaWdodFZhbHVlICo9IC0xO1xyXG4gICAgICAgICAgICAgICAgY3VycmVudFdpZHRoVmFsdWUgKj0gLTE7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgc3dpdGNoICh0aGlzLmRpcmVjdGlvbikge1xyXG4gICAgICAgICAgICBjYXNlIEFuZ3VsYXJSZXNpemVFbGVtZW50RGlyZWN0aW9uLlRPUDpcclxuICAgICAgICAgICAgY2FzZSBBbmd1bGFyUmVzaXplRWxlbWVudERpcmVjdGlvbi5CT1RUT006IHtcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRXaWR0aFZhbHVlID0gMDtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNhc2UgQW5ndWxhclJlc2l6ZUVsZW1lbnREaXJlY3Rpb24uUklHSFQ6XHJcbiAgICAgICAgICAgIGNhc2UgQW5ndWxhclJlc2l6ZUVsZW1lbnREaXJlY3Rpb24uTEVGVDoge1xyXG4gICAgICAgICAgICAgICAgY3VycmVudEhlaWdodFZhbHVlID0gMDtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjdXJyZW50V2lkdGhWYWx1ZSArPSB0aGlzLnRhcmdldEVsZW1lbnRXaWR0aFZhbHVlO1xyXG4gICAgICAgIGN1cnJlbnRIZWlnaHRWYWx1ZSArPSB0aGlzLnRhcmdldEVsZW1lbnRIZWlnaHRWYWx1ZTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMucHJvcG9ydGlvbmFsUmVzaXplKSB7XHJcbiAgICAgICAgICAgIGlmIChjdXJyZW50V2lkdGhWYWx1ZSA+IGN1cnJlbnRIZWlnaHRWYWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgY3VycmVudFdpZHRoVmFsdWUgPSBjdXJyZW50SGVpZ2h0VmFsdWU7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjdXJyZW50SGVpZ2h0VmFsdWUgPSBjdXJyZW50V2lkdGhWYWx1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgb3JpZ2luYWxFdmVudDogdGhpcy5vcmlnaW5hbEV2ZW50LFxyXG4gICAgICAgICAgICBjdXJyZW50V2lkdGhWYWx1ZTogY3VycmVudFdpZHRoVmFsdWUsXHJcbiAgICAgICAgICAgIGN1cnJlbnRIZWlnaHRWYWx1ZTogY3VycmVudEhlaWdodFZhbHVlLFxyXG4gICAgICAgICAgICBvcmlnaW5hbFdpZHRoVmFsdWU6IHRoaXMudGFyZ2V0RWxlbWVudFdpZHRoVmFsdWUsXHJcbiAgICAgICAgICAgIG9yaWdpbmFsSGVpZ2h0VmFsdWU6IHRoaXMudGFyZ2V0RWxlbWVudEhlaWdodFZhbHVlLFxyXG4gICAgICAgICAgICBkaWZmZXJlbmNlV2lkdGhWYWx1ZTogdGhpcy50YXJnZXRFbGVtZW50V2lkdGhWYWx1ZSAtIGN1cnJlbnRXaWR0aFZhbHVlLFxyXG4gICAgICAgICAgICBkaWZmZXJlbmNlSGVpZ2h0VmFsdWU6IHRoaXMudGFyZ2V0RWxlbWVudEhlaWdodFZhbHVlIC0gY3VycmVudEhlaWdodFZhbHVlLFxyXG4gICAgICAgICAgICBkaXJlY3Rpb246IHRoaXMuZGlyZWN0aW9uLFxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbiJdfQ==